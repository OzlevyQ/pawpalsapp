# 🐕 מסמך תיעוד פרויקט DogPark - PawPals

## 📋 סקירה כללית
**PawPals** היא אפליקציית רשת חברתית מקיפה לבעלי כלבים, המאפשרת חיבור בין בעלי כלבים, ניהול גני כלבים, ארגון אירועים ומערכת גיימיפיקציה מתקדמת.

### מאפיינים עיקריים:
- 🌍 **מיפוי גני כלבים** - חיפוש וגילוי גנים בסביבה
- 👥 **רשת חברתית** - חברויות, צ'אטים ושיתוף תמונות
- 📅 **ניהול אירועים** - יצירת והרשמה לאירועים בגנים
- 🏆 **גיימיפיקציה** - נקודות, תגים, הישגים ולוחות מובילים
- 📱 **אפליקציית מובייל** - תמיכה ב-Android ו-iOS דרך Capacitor
- 🔔 **התראות בזמן אמת** - WebSocket לעדכונים מידיים

---

## 🏗️ ארכיטקטורת המערכת

### מבנה הפרויקט
```
DogPark/
├── backend/              # שרת Node.js/Express
│   ├── src/
│   │   ├── controllers/  # בקרים לניהול לוגיקה עסקית
│   │   ├── models/       # מודלים של MongoDB
│   │   ├── routes/       # נתיבי API
│   │   ├── middleware/   # אימות והרשאות
│   │   ├── services/     # שירותי גיימיפיקציה
│   │   └── utils/        # כלי עזר ושירותים
│   └── server.js         # נקודת כניסה לשרת
├── frontend/             # אפליקציית צד לקוח (קומפיילד)
│   ├── dist/            # קבצים סטטיים
│   ├── android/         # פרויקט Android
│   └── ios/             # פרויקט iOS
└── PawPalsWeb#donttouch/ # גרסה קודמת (ארכיון)
```

---

## 🗄️ מודלים במסד הנתונים

### מודלים עיקריים

#### 1. **User** - משתמש
- **פרטים בסיסיים**: email, username, password, googleId
- **פרופיל**: firstName, lastName, phone, profileImage
- **תפקידים**: admin, garden_manager, dog_owner
- **הרשאות אירועים**: canCreateEvents, canManageAllEvents
- **גיימיפיקציה**: points, level, currentStreak, badges
- **מיקום**: location עם אינדקס גיאוגרפי

#### 2. **Dog** - כלב
- **מידע בסיסי**: name, breed, age, gender, size, weight
- **בריאות**: חיסונים, בעיות רפואיות, תרופות
- **אישיות**: friendly, energetic, social (סקאלה 1-5)
- **דירוג קהילתי**: averageRating, ratingCount
- **פופולריות**: friendsCount, status (new → community-favorite)

#### 3. **Garden** - גן כלבים
- **פרטים**: name, description, type (public/private)
- **ניהול תפוסה**: maxDogs, currentOccupancy
- **שעות פעילות**: openingHours (7 ימים)
- **מתקנים**: amenities, rules, requirements
- **ניהול אירועים**: eventSettings
- **ניוזלטר**: מערכת דיוור לגן

#### 4. **Event** - אירוע
- **פרטי אירוע**: title, description, eventDate, startTime
- **רישום**: participants, waitingList, maxParticipants
- **דרישות**: חיסונים, הגבלות גודל/גיל
- **סטטוס**: upcoming → ongoing → completed → cancelled

### מודלי תמיכה
- **Visit** - צ'ק-אין/אאוט בגנים
- **Review** - ביקורות ודירוגים
- **Friendship** - קשרי חברות
- **Message** - מערכת הודעות
- **Notification** - התראות
- **Photo** - ניהול תמונות

### מודלי גיימיפיקציה
- **Achievement** - הישגים
- **Badge** - תגים עם רמות נדירות
- **Mission** - משימות יומיות/שבועיות
- **Guild** - קבוצות חברתיות
- **Leaderboard** - לוחות מובילים
- **DogRating** - דירוג כלבים קהילתי
- **DogJournal** - יומן מפגשי כלבים

---

## 🛣️ API Endpoints

### אימות (/api/auth)
```
POST /register         - רישום משתמש חדש
POST /login           - כניסה למערכת
POST /logout          - יציאה מהמערכת
POST /google          - כניסה עם Google
```

### משתמשים (/api/users)
```
GET    /profile                  - קבלת פרופיל
PUT    /profile                  - עדכון פרופיל
POST   /change-password          - שינוי סיסמה
GET    /favorites                - גנים מועדפים
POST   /favorites                - הוספת גן למועדפים
DELETE /favorites/:gardenId      - הסרת גן ממועדפים
```

### גני כלבים (/api/gardens)
```
GET    /                         - כל הגנים
GET    /nearby                   - גנים בסביבה
GET    /search-dog-parks         - חיפוש ב-Google Places
GET    /:id                      - פרטי גן
POST   /                         - יצירת גן (מנהלים)
PUT    /:id                      - עדכון גן
DELETE /:id                      - מחיקת גן (אדמין)
```

### אירועים (/api/events)
```
GET    /                         - כל האירועים
GET    /:id                      - פרטי אירוע
POST   /                         - יצירת אירוע
POST   /:eventId/register        - רישום לאירוע
DELETE /:eventId/register        - ביטול רישום
PUT    /:id                      - עדכון אירוע
DELETE /:id                      - ביטול אירוע
```

### כלבים (/api/dogs)
```
GET    /                         - כל הכלבים
GET    /my-dogs                  - הכלבים שלי
GET    /:id                      - פרטי כלב
POST   /                         - הוספת כלב
PUT    /:id                      - עדכון כלב
DELETE /:id                      - מחיקת כלב
```

### נוספים
- **/api/visits** - ניהול ביקורים בגנים
- **/api/reviews** - ביקורות ודירוגים
- **/api/chats** - צ'אטים בזמן אמת
- **/api/friendships** - ניהול חברויות
- **/api/photos** - שיתוף תמונות
- **/api/notifications** - התראות
- **/api/admin** - פעולות ניהול

---

## 🔐 אבטחה והרשאות

### שיטות אימות
1. **JWT Tokens** - אימות מבוסס טוקנים עם מטמון
2. **Google OAuth** - כניסה עם חשבון Google
3. **In-Memory Cache** - מטמון משתמשים ל-5 דקות

### רמות הרשאה
1. **Public** - גישה חופשית (חיפוש גנים)
2. **Authenticated** - משתמשים מחוברים
3. **Garden Manager** - מנהלי גנים
4. **Admin** - מנהלי מערכת

### Middleware
- `auth` - אימות JWT עם מטמון
- `authorize(...roles)` - בדיקת תפקידים
- `canCreateEvents` - הרשאות יצירת אירועים
- `canManageEvents` - הרשאות ניהול אירועים

---

## 🎮 מערכת גיימיפיקציה

### רכיבים
1. **נקודות (Points)**
   - ביקור בגן: 10 נקודות
   - יצירת אירוע: 50 נקודות
   - ביקורת: 15 נקודות
   - צילום: 5 נקודות

2. **רמות (Levels)**
   - חישוב אוטומטי לפי נקודות
   - בונוסים לרמות גבוהות

3. **תגים (Badges)**
   - תגי הישג מיוחדים
   - רמות נדירות: common → legendary

4. **רצפים (Streaks)**
   - רצף ביקורים יומי
   - בונוסים לרצפים ארוכים

5. **משימות (Missions)**
   - משימות יומיות/שבועיות/חודשיות
   - פרסים להשלמת משימות

---

## 🔧 שירותים ותשתיות

### שירותי Backend

#### BadgeService
- ניהול והענקת תגים
- חישוב נדירות

#### LevelService
- חישוב רמות משתמש
- ניהול התקדמות

#### PointsService
- הענקת נקודות
- מעקב הישגים

#### StreakService
- ניהול רצפי ביקורים
- חישוב בונוסים

### שירותי תשתית

#### EmailService
- תבניות מייל בעברית/אנגלית
- עיצוב HTML מקצועי
- מיילים לאורך מחזור חיי אירוע

#### NotificationService
- 14 סוגי התראות
- רמות עדיפות
- ניקוי אוטומטי אחרי 30 יום

#### WebSocketService
- תקשורת בזמן אמת
- אימות מבוסס JWT
- מגבלת 1000 חיבורים
- Heartbeat למעקב חיבורים

---

## 🌍 אינטגרציות חיצוניות

### Google Places API
- חיפוש גני כלבים מתקדם
- תמיכה רב-שפתית
- מעקב עלויות API
- סינון חכם של תוצאות
- חישוב מרחקים (Haversine)

### Web Push
- התראות דחיפה לדפדפן
- תמיכה ב-PWA

---

## 📱 צד לקוח

### טכנולוגיות
- **Framework**: React (קומפיילד)
- **Mobile**: Capacitor
- **PWA**: Progressive Web App
- **פלטפורמות**: Android, iOS, Web

### יכולות מובייל
- **גיאולוקציה** - מיקום נוכחי
- **מצלמה** - צילום ושיתוף
- **התראות מקומיות** - תזכורות
- **התראות Push** - עדכונים בזמן אמת
- **שיתוף** - שיתוף תוכן

---

## 🚀 תצורת שרת

### סביבת Production
- **פלטפורמה**: Render.com
- **מסד נתונים**: MongoDB Atlas
- **Node.js**: 18+
- **SSL**: HTTPS מאובטח

### משתני סביבה
- `MONGODB_URI` - חיבור למסד נתונים
- `JWT_SECRET` - מפתח הצפנה
- `GOOGLE_API_KEY` - מפתח Google
- `NODE_ENV` - production/development

### ניטור
- **Health Check**: `/api/health`
- **Database Monitoring**: סטטוס חיבור
- **API Usage Tracking**: מעקב עלויות
- **Error Logging**: לוגים מפורטים

---

## 📊 סטטיסטיקות פרויקט

### היקף
- **22 מודלים** במסד נתונים
- **60+ API Endpoints**
- **16 מודולי ראוטינג**
- **14 סוגי התראות**
- **4 שירותי גיימיפיקציה**

### תכונות מתקדמות
- ✅ אימות JWT + OAuth
- ✅ WebSocket בזמן אמת
- ✅ גיאולוקציה וחיפוש
- ✅ מערכת הרשאות מורכבת
- ✅ תמיכה דו-לשונית (עברית/אנגלית)
- ✅ PWA + Native Apps
- ✅ גיימיפיקציה מלאה
- ✅ מערכת דיוור מתקדמת

---

## 🎯 תכונות עיקריות למשתמש

1. **חיפוש וגילוי גנים** - מציאת גני כלבים בסביבה
2. **צ'ק-אין בגנים** - רישום נוכחות ומעקב
3. **רשת חברתית** - חיבור עם בעלי כלבים אחרים
4. **ארגון אירועים** - יצירת מפגשים קהילתיים
5. **פרופיל כלב מותאם** - עיצוב אישי עם HTML/CSS
6. **דירוג קהילתי** - דירוג כלבים וגנים
7. **יומן מפגשים** - תיעוד מפגשי כלבים
8. **תחרויות ואתגרים** - משימות יומיות ופרסים
9. **צ'אט בזמן אמת** - תקשורת מיידית
10. **ניוזלטר גנים** - עדכונים מגנים מועדפים

---

## 📝 הערות חשובות

1. **הפרויקט מוכן לייצור** עם טיפול בשגיאות, ניטור ואופטימיזציות
2. **ארכיטקטורה ברמת Enterprise** עם תכנון לסקלביליות
3. **אבטחה מתקדמת** עם הצפנה, אימות והרשאות
4. **חווית משתמש עשירה** עם גיימיפיקציה ותכונות חברתיות
5. **תמיכה מלאה במובייל** דרך PWA ואפליקציות native

---

## 🔜 שדרוגים אחרונים
- ✅ אינטגרציית מפות
- ✅ קודי QR לגנים
- ✅ אירועי בעלי גנים
- ✅ בקשות משתמשים לאירועים

---

## ⚡ ביצועים ואופטימיזציות
- **אינדקסים גיאוגרפיים** לחיפושי מיקום
- **Compound Indexes** לשאילתות מורכבות
- **מטמון משתמשים** בזיכרון
- **Lean Queries** ב-MongoDB
- **Connection Pooling** לניהול חיבורים

---

**מסמך זה הוא מסמך חשוב ומרכזי להבנת הפרויקט DogPark/PawPals** 🐕✨